---
import type { GetStaticPaths } from "astro";
import Article from "@/components/Article.astro";
import { getCollection } from "astro:content";
import ArticleList from "@/layouts/ArticleList.astro";
import Pagination from "@/components/Pagination.astro";

export const getStaticPaths = (async ({ paginate }) => {
  const posts = (await getCollection("blog")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
  );

  return paginate(posts, {
    pageSize: 6,
  });
}) satisfies GetStaticPaths;

const { page } = Astro.props;
---

<ArticleList>
  {page.data.map((post) => <Article {...post.data} slug={post.slug} body={post.body} />)}
</ArticleList>
<Pagination
  prevUrl={page.url.prev}
  nextUrl={page.url.next}
  currentPage={page.currentPage}
  lastPage={page.lastPage}
/>
